<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width">
    <title>AliAlperenASLAN</title>
</head>
<style>
* { margin:0;
	padding:0; }

html, body { width:100%; height:100%; }
canvas { display:block; }

	#container {
			width		: 100%;
			height		: 100%;
			overflow	: hidden;
			padding		: 0;
			margin		: 0;
			-webkit-user-select	: none;
			-moz-user-select	: none;
		}
</style>
<html>
<body>

<script src="virtualjoystick.js"></script>
		<script>
			
		</script>

</body>
<script>
console.log("touchscreen is", VirtualJoystick.touchScreenAvailable() ? "available" : "not available");
	
			var joystick	= new VirtualJoystick({
				container	: document.getElementById('container'),
				mouseSupport	: true,
			});
			joystick.addEventListener('touchStart', function(){
					player.shot();
			})
			joystick.addEventListener('touchEnd', function(){
				player.shot();
			})
			setInterval(function(){
				
				     
					+ ' dx:'+joystick.deltaX()
					+ ' dy:'+joystick.deltaY()
					+ (joystick.right()	? ' right'	: '')
					+ (joystick.up()	? ' up'		: '')
					+ (joystick.left()	? ' left'	: '')
					+ (joystick.down()	? ' down' 	: '')	
			}, 1/30 * 1000);



function randomNumber(min, max) {
    return Math.floor(Math.random() * (max - min + 1) + min);
};


//tanımlamalar
var score = 0;
var starArray = [];
var enemyArray = [];
var keyboardArray = [];
var shotArray = [];


//canvas oluşturma 
canvas = document.createElement('canvas');
canvas.id = 'screen';
//body canvası ekleme
document.body.appendChild(canvas);
//canvas boyutları
canvas.width = window.innerWidth;
canvas.height = window.innerHeight;
// canvas getContext(2d)
var canvas = document.getElementById('screen');
var screenWidth = canvas.width;
var screenHeight = canvas.height;

var ctx = canvas.getContext("2d");

var player = new Player();




function gameLoop() {


   //sürekli devam sağlamak için
    window.requestAnimationFrame(gameLoop);

	//arka plan oluşturma
        ctx.fillStyle = "#000000";
        ctx.fillRect(0, 0, screenWidth, screenHeight);
		//belirli sayıda arka plan için yıldız 
        if (randomNumber(1, 100) < 50) {
           starArray.push(new Star());
        }
		//belirli sayıda arka plan düşman 
		 if (randomNumber(1, 100) < 2) {
            enemyArray.push(new Enemy());
        }   
        draw();
}
function randomNumber(min, max) {
    return Math.floor(Math.random() * (max - min + 1) + min);
};
//star class
function Star(){
    //star x, y 
    this.x = randomNumber(1, screenWidth);
    this.y = 0;
    //boyut 
    this.radius = 1;
    //bir sonra ki hareket için ikinci 
    this.yd = randomNumber(1, 8);
    this.color = "white";
} 
//shot class
function Shot() {
    this.size = 10;
    this.color = 'cyan';
    this.radius = 5;
    this.x = player.x;
    this.y = player.y;
    this.yd = 10;
}

function draw() {
  
    drawStars();
    drawPlayer();
	drawEnemy();
	drawShot();
    drawScore();
}


function drawStars() {
    //yıldız arrayinde dolaşarak yıldızları oluşturuyor
    for (var i = 0; i < starArray.length; i++) {
        ctx.fillStyle = starArray[i].color;
        ctx.beginPath();
        ctx.arc(starArray[i].x, starArray[i].y, starArray[i].radius, 0, Math.PI *2);
        ctx.fill();
        ctx.closePath();
        starArray[i].y += starArray[i].yd;
        
    }
   
}

function drawEnemy() {
    for (var i = 0; i < enemyArray.length; i++) {
        ctx.fillStyle = enemyArray[i].color;
        ctx.beginPath();
        ctx.arc(enemyArray[i].x, enemyArray[i].y, enemyArray[i].radius, 0, Math.PI * 2);
        ctx.fill();
        ctx.closePath();
        enemyArray[i].y += enemyArray[i].yd;
        if (enemyArray[i].y > screenHeight) {
			
            enemyArray.splice(i, 1);
        }
    }
}
//player classı
function Player() {
    this.size = 50;
    this.x = (screenWidth-50) / 2;
    this.y = (screenHeight-75);
    this.speed = 5;
    this.key = false;
    this.shots = 0;
	
   this.moveLeft = function () {
        this.x -= this.speed;
    };
    this.moveRight = function () {
        this.x += this.speed;
    };
    this.moveUp = function () {
        this.y -= this.speed;
    };
    this.moveDown = function () {
        this.y += this.speed;
    };
    this.shot = function () {
        if (shotArray.length === 0) {
            shotArray.push(new Shot());
        }
    };
}
//enemy class
function Enemy() {
    this.x = randomNumber(player.size, screenWidth-50);
    this.y = 0;
    this.color = 'green';
    this.radius = 20;
    this.yd = 3;
}


  

function drawPlayer(){
	
	  if ((keyboardArray[37] || joystick.left() )&& (player.x + player.size) > player.size * 2) {
        player.moveLeft();    
    }
     
    if ((keyboardArray[39] || joystick.right() )&& (player.x + player.size) < screenWidth) {
        player.moveRight();
    }
    
    if ((keyboardArray[38]  || joystick.up() )&& (player.y + player.size) > player.size) {
        player.moveUp();    
    }
    
    if ((keyboardArray[40]  || joystick.down()) && (player.y + player.size) < screenHeight) {
        player.moveDown();
    }
    
    if (keyboardArray[32]) {
        player.shot();
          
    }



    ctx.beginPath();
    ctx.moveTo(player.x, player.y);
    ctx.lineTo(player.x - player.size, player.y + player.size);
    ctx.lineTo(player.x + player.size, player.y + player.size);
    ctx.closePath();
    ctx.fillStyle = "cyan";
    ctx.fill();

}
function drawShot() {
    for (var i = 0; i < shotArray.length; i++) {
        ctx.fillStyle = shotArray[i].color;
        ctx.beginPath();
        ctx.arc(shotArray[i].x, shotArray[i].y, shotArray[i].radius, 0, Math.PI * 2);
        ctx.fill();
        ctx.closePath();
        shotArray[i].y -= shotArray[i].yd;
        
        if (shotArray[i].y < 1) {
			//Shot array de ki y ekseninde  ekrandan çıkınca silinmesi için
            shotArray.splice(i, 1);
            continue;            
        }
        for (var j = 0; j < enemyArray.length; j++) {
            if (distance(shotArray[i], enemyArray[j]) < enemyArray[j].radius) {
                enemyArray.splice(j, 1);
                score += 1;
                drawEnemy();
                shotArray.splice(i, 1);
            } 
        }
		
        
      
    }
}
function drawScore() {
      ctx.font = "50px Verdana bold" ;
      ctx.fillStyle = "white";
      ctx.textAlign = "right";
      ctx.fillText(score, screenWidth - 20, 60);
    };
function distance(a, b) {
    return Math.sqrt(Math.pow((b.x - a.x), 2) + Math.pow((b.y - a.y), 2));
};

document.addEventListener('keydown', function (e) {
    keyboardArray[e.keyCode] = true;
});

document.addEventListener('keyup', function (e) {
    keyboardArray[e.keyCode] = false;
});




gameLoop();


</script>

</html>